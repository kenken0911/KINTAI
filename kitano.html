<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>勤怠管理システム</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+JP:wght@300;400&display=swap');

    body {
      font-family: 'Noto Sans JP', sans-serif;
      background: #0a0a1a;
      overflow: hidden;
      position: relative;
    }
    
    .font-orbitron {
      font-family: 'Orbitron', sans-serif;
    }

    /* 背景のグリッド線 */
    .grid-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
      background-size: 40px 40px;
      z-index: -1;
      animation: pan-grid 60s linear infinite;
    }

    @keyframes pan-grid {
      0% { background-position: 0 0; }
      100% { background-position: 480px 480px; }
    }

    /* Glassmorphism Effect */
    .glass-panel {
      background: rgba(10, 20, 40, 0.6);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 255, 255, 0.2);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
    }

    /* ボタンのスタイル */
    .control-btn {
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      border: 1px solid;
      text-shadow: 0 0 5px currentColor;
    }
    .control-btn:before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 300%;
      height: 300%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.2), transparent 40%);
      transform: translate(-50%, -50%) scale(0);
      transition: all 0.5s ease;
    }
    .control-btn:hover:not(:disabled) {
      box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
    }
    .control-btn:active:not(:disabled):before {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0;
      transition: transform 0s, opacity 0.5s;
    }
    .control-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* ローディングスピナー */
    .loader {
      border-top-color: #00ffff;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* スクロールバーのスタイル */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 255, 255, 0.05); }
    ::-webkit-scrollbar-thumb { background: rgba(0, 255, 255, 0.3); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0, 255, 255, 0.5); }
  </style>
</head>
<body class="text-slate-200">
  <div class="grid-background"></div>
  
  <div class="container mx-auto p-4 md:p-8 max-w-2xl min-h-screen flex flex-col justify-center relative z-10">
    
    <header class="text-center mb-8">
      <h1 class="font-orbitron text-3xl md:text-4xl font-bold text-cyan-300 tracking-widest uppercase" style="text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;">
        Kintai System
      </h1>
      <p class="text-cyan-200 opacity-80">勤怠管理システム</p>
    </header>

    <div id="control-panel" class="glass-panel p-6 rounded-2xl mb-8">
      <div class="mb-6">
        <label class="block text-sm font-medium text-cyan-200 mb-2">Operator Name</label>
        <div id="name-display" class="w-full px-4 py-2 bg-black bg-opacity-30 border border-cyan-500/30 rounded-lg text-lg font-orbitron text-cyan-300">
          <!-- JavaScriptで名前がここに表示されます -->
        </div>
      </div>
      
      <div id="button-container" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <button id="start-btn" class="control-btn w-full py-3 rounded-lg font-bold text-lg border-green-400 text-green-300">
          勤務開始
        </button>
        <button id="end-btn" class="control-btn w-full py-3 rounded-lg font-bold text-lg border-red-400 text-red-300">
          勤務終了
        </button>
      </div>

      <div id="message-area" class="mt-4 text-center text-sm min-h-[20px] transition-all duration-300"></div>
    </div>

    <div id="status-panel" class="glass-panel p-6 rounded-2xl flex-grow flex flex-col overflow-hidden">
      <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-cyan-300 font-orbitron">現在の勤務者</h2>
          <div id="status-loader" class="loader ease-linear rounded-full border-4 border-t-4 border-gray-500 h-6 w-6 hidden"></div>
      </div>
      <div id="worker-list-container" class="overflow-y-auto pr-2 flex-grow">
          <ul id="worker-list" class="space-y-3">
             <!-- 勤務者リストがここに表示されます -->
          </ul>
          <p id="no-worker-msg" class="text-center text-slate-400 mt-4">現在、勤務中の人はいません。</p>
      </div>
    </div>
    
  </div>

  <script>
    // ▼▼▼ あなたの設定 ▼▼▼
    // このHTMLファイルを使う人の名前をここに書きます
    const USER_NAME = "北野賢一郎"; 
    
    // GASをデプロイして取得した新しいウェブアプリのURLを貼り付けてください
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbynM3Uoy_FbjvZY4YSJyR92vlyLcADJb-kYw0QU8qi2jZdAPgccbzXXYy6luY7DZeuU/exec";
    // ▲▲▲ 設定はここまで ▲▲▲

    // ----------------------------------------
    // Sound Effects
    // ----------------------------------------
    // スクリプト読み込み時に効果音を準備します
    const startSound = new Audio("data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU9vT18AAACAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA-");
    const endSound = new Audio("data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAQAAAACc/p3+mf6c/pv+m/6c/p3+nP6e/pz+nP6c/p3+m/6Z/pn+mP6Y/pf+l/6W/pb+l/6X/pf+mP6Y/pj+l/6W/pX+lf6V/pX+l/6X/pf+mP6Y/pr+nP6e/p/+pP6n/qf+qP6p/qn+qP6r/qv+r/6w/rD+sP6w/rD+r/6v/q/+p/6n/qT+pP6j/qP+o/6j/qP+o/6j/qP+pP6k/qP+o/6f/p/+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6b/pv+m/6-");
    const errorSound = new Audio("data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQBJAAAAAP//8/7u/Oz86vzr/O388fzw/PH88vzz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP8s-");
    startSound.volume = 0.5;
    endSound.volume = 0.5;
    errorSound.volume = 0.3;

    // ----------------------------------------
    // 要素の取得
    // ----------------------------------------
    const nameDisplay = document.getElementById('name-display');
// ... existing code ... */
    // メイン関数
    // ----------------------------------------

    async function checkStatusOnLoad(name) {
// ... existing code ... */
    }

    async function handleStart() {
      startSound.play();
      setLoading(true);
      try {
        const data = await callGasApi('startWork', { name: USER_NAME });
// ... existing code ... */
      } finally {
        setLoading(false);
      }
    }

    async function handleEnd() {
      endSound.play();
      const id = localStorage.getItem(userStorageKey);
      if (!id) {
        showMessage('ローカルIDが見つかりません。リロードしてください。', 'error');
// ... existing code ... */
      } finally {
        setLoading(false);
      }
    }

    async function updateStatus() {
// ... existing code ... */
    }

    // ----------------------------------------
    // UIヘルパー関数
    // ----------------------------------------

    function handleError(error) {
      errorSound.play();
      showMessage(`エラーが発生しました: ${error.message}`, 'error');
    }

    function showMessage(msg, type = 'info') {
// ... existing code ... */
    }
    
    function setWorkingState(isWorking) {
// ... existing code ... */
    }

    function setLoading(isLoading) {
// ... existing code ... */
      } else {
        document.body.classList.remove('cursor-wait');
        setWorkingState(!!savedId);
      }
    }
  </script>
</body>
</html>

